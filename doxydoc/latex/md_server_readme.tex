\doxysection*{RFC for R-\/\+Type Game Engine Networking Protocol}

\doxysubsection*{Request for Comments\+: 1001}

{\bfseries{Category\+:}} Experimental

{\bfseries{Updated\+:}} September 2024

{\bfseries{Author\+:}} Fizo55

\DoxyHorRuler{0}


\doxysubsection*{Abstract}

This RFC defines the binary protocol used in the multiplayer R-\/\+Type game for communication between clients and the game server. The protocol facilitates the real-\/time exchange of game states, player inputs, and other gameplay events over the network, using UDP as the primary transport layer for in-\/game communications. The protocol is designed to minimize latency while ensuring consistency between all players in the game.

\DoxyHorRuler{0}


\doxysubsection*{1. Introduction}

R-\/\+Type is a networked multiplayer game where several players fight the evil Bydos in real-\/time. The game\textquotesingle{}s protocol governs all client-\/server communications, including player movements, enemy spawning, missile firing, and game updates.

The protocol is {\bfseries{binary-\/based}} to optimize bandwidth efficiency, and it uses {\bfseries{UDP}} to prioritize speed. Some critical messages (e.\+g., connection setup) will use {\bfseries{TCP}} for reliability. This RFC outlines the message structure, data encoding, and methods for handling network unreliability like packet loss.

\doxysubsection*{2. Transport Layer}

\doxysubsubsection*{2.\+1 UDP Usage}


\begin{DoxyItemize}
\item {\bfseries{UDP}} is the primary transport protocol used for real-\/time game state synchronization between clients and the server. This ensures low-\/latency communication, but since UDP is inherently unreliable, mechanisms to handle packet loss, duplication, and out-\/of-\/order packets are built into the protocol. 
\end{DoxyItemize}

\doxysubsubsection*{2.\+2 TCP Usage}


\begin{DoxyItemize}
\item {\bfseries{TCP}} is employed only for critical communications like connection initiation, user authentication, and game session management. This ensures that important information is transmitted reliably, even at the expense of some delay. 
\end{DoxyItemize}

\DoxyHorRuler{0}


\doxysubsection*{3. Message Structure}

Each message in the protocol consists of a {\bfseries{header}} and a {\bfseries{payload}}. The header contains metadata about the message, while the payload contains the actual game-\/related data.

\doxysubsubsection*{3.\+1 Header Format (8 bytes)}

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{0}{|X[-1]}|}
\hline
\end{longtabu}


Field 

Size 

Description  $<$/thead$>$ $<$tbody$>$ 

Message ID 

2 bytes 

A unique identifier for each type of message.  

Sequence No 

2 bytes 

A sequence number for tracking packets in UDP.  

Client ID 

2 bytes 

Identifies the client or player sending the message.  

Flags 

2 bytes 

Special control flags (e.\+g., ACK, RE-\/\+TRANSMIT).  $<$/tbody$>$ 

\doxysubsubsection*{3.\+2 Payload Format}

The payload format depends on the type of message. Each message type is described below, including its unique {\bfseries{Message ID}} and payload structure.

\DoxyHorRuler{0}


\doxysubsection*{4. Protocol Messages}

\doxysubsubsection*{4.\+1 Connection Management}

\doxyparagraph*{4.\+1.\+1 {\ttfamily CONNECT\+\_\+\+REQUEST} (Message ID\+: 0x0001)}

Sent by the client to request connection to the server.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{0}{|X[-1]}|}
\hline
\end{longtabu}


Field 

Size 

Description  $<$/thead$>$ $<$tbody$>$ 

Client Name 

32 bytes 

The name of the player.  $<$/tbody$>$ 

\doxyparagraph*{4.\+1.\+2 {\ttfamily CONNECT\+\_\+\+RESPONSE} (Message ID\+: 0x0002)}

Sent by the server to acknowledge the connection request and provide the client\textquotesingle{}s ID.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{0}{|X[-1]}|}
\hline
\end{longtabu}


Field 

Size 

Description  $<$/thead$>$ $<$tbody$>$ 

Client ID 

2 bytes 

The unique ID assigned by the server.  $<$/tbody$>$ 

\DoxyHorRuler{0}


\doxysubsubsection*{4.\+2 Game State Updates}

\doxyparagraph*{4.\+2.\+1 {\ttfamily PLAYER\+\_\+\+MOVE} (Message ID\+: 0x1001)}

Sent by the client to indicate player movement.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{0}{|X[-1]}|}
\hline
\end{longtabu}


Field 

Size 

Description  $<$/thead$>$ $<$tbody$>$ 

PosX 

2 bytes 

The player\textquotesingle{}s X position.  

PosY 

2 bytes 

The player\textquotesingle{}s Y position.  

Direction 

1 byte 

Direction (0\+: Left, 1\+: Right, etc.).  $<$/tbody$>$ 

\doxyparagraph*{4.\+2.\+2 {\ttfamily FIRE\+\_\+\+MISSILE} (Message ID\+: 0x1002)}

Sent by the client when firing a missile.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{0}{|X[-1]}|}
\hline
\end{longtabu}


Field 

Size 

Description  $<$/thead$>$ $<$tbody$>$ 

Missile\+Type 

1 byte 

The type of missile fired.  

PosX 

2 bytes 

The missile\textquotesingle{}s starting X position.  

PosY 

2 bytes 

The missile\textquotesingle{}s starting Y position.  $<$/tbody$>$ 

\doxyparagraph*{4.\+2.\+3 {\ttfamily ENEMY\+\_\+\+SPAWN} (Message ID\+: 0x2001)}

Sent by the server to inform clients of a new enemy spawn.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{0}{|X[-1]}|}
\hline
\end{longtabu}


Field 

Size 

Description  $<$/thead$>$ $<$tbody$>$ 

Enemy ID 

2 bytes 

The unique ID of the spawned enemy.  

PosX 

2 bytes 

The X position of the enemy.  

PosY 

2 bytes 

The Y position of the enemy.  

Enemy\+Type 

1 byte 

Type of enemy spawned.  $<$/tbody$>$ 

\doxyparagraph*{4.\+2.\+4 {\ttfamily ENTITY\+\_\+\+DESTROYED} (Message ID\+: 0x2002)}

Sent by the server when an entity (player, enemy, missile) is destroyed.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{0}{|X[-1]}|}
\hline
\end{longtabu}


Field 

Size 

Description  $<$/thead$>$ $<$tbody$>$ 

Entity ID 

2 bytes 

ID of the destroyed entity.  

PosX 

2 bytes 

X position of the destruction.  

PosY 

2 bytes 

Y position of the destruction.  $<$/tbody$>$ 

\DoxyHorRuler{0}


\doxysubsection*{5. Reliability Mechanisms}

\doxysubsubsection*{5.\+1 Sequence Numbering}

Each UDP packet contains a {\bfseries{Sequence Number}} in the header. The server and clients use this sequence number to detect and handle out-\/of-\/order or duplicate packets.

\doxysubsubsection*{5.\+2 Acknowledgments (ACK)}


\begin{DoxyItemize}
\item Critical messages, such as those handling connection and disconnection, will require {\bfseries{ACK}} messages to confirm successful delivery. These messages will include the ACK flag in the header. 
\end{DoxyItemize}

\doxysubsubsection*{5.\+3 Retransmission}

If an expected ACK is not received within a predefined timeout, the sender will re-\/transmit the message. Each message will have a retransmission counter to avoid infinite loops.

\DoxyHorRuler{0}


\doxysubsection*{6. Error Handling}

\doxysubsubsection*{6.\+1 Invalid Messages}

If a client or server receives a message that doesn\textquotesingle{}t conform to the protocol (e.\+g., corrupted or invalid message ID), it will ignore the message and send an {\ttfamily ERROR\+\_\+\+RESPONSE} message (Message ID\+: 0x9999) with an error code indicating the issue.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{0}{|X[-1]}|}
\hline
\end{longtabu}


Field 

Size 

Description  $<$/thead$>$ $<$tbody$>$ 

Error\+Code 

2 bytes 

Error code describing the failure.  $<$/tbody$>$ 

\doxysubsubsection*{6.\+2 Packet Loss}

The protocol is designed to tolerate packet loss, especially during gameplay updates (e.\+g., player position, missile firing). The game will continue even if some position or action updates are missed, but key events (e.\+g., death, pickups) are sent with guaranteed delivery mechanisms.

\DoxyHorRuler{0}


\doxysubsection*{7. Security Considerations}


\begin{DoxyItemize}
\item {\bfseries{Client Authentication}}\+: Each client must authenticate with the server using a secure method during connection establishment. 
\item {\bfseries{Data Validation}}\+: All incoming data must be validated to prevent buffer overflows, memory corruption, and other security risks. 
\item {\bfseries{Replay Protection}}\+: Sequence numbers prevent replay attacks by ensuring that old or duplicated packets are ignored. 
\end{DoxyItemize}

\DoxyHorRuler{0}


\doxysubsection*{8. Conclusion}\hypertarget{md_server_readme_autotoc_md9}{}\doxysubsection{$<$p$>$\+This protocol is designed to optimize real-\/time gameplay in R-\/\+Type by balancing low-\/latency UDP communication with mechanisms to ensure critical message reliability. The binary format ensures efficient transmission, while the use of sequence numbers and ACKs helps mitigate the inherent unreliability of UDP.$<$/p$>$}\label{md_server_readme_autotoc_md9}
\doxysubsubsection*{Authors\+:}

Fizo55